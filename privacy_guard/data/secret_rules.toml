# Secret detection rules — converted from leakguard (Rust)
# Source: /Users/adrian/Git/pyl/src/rules.rs
#
# Pattern format: TOML multi-line literal strings ('''...''').
# Backslashes are literal — no TOML escaping needed.
# Python re flags applied at load time: re.UNICODE always; re.MULTILINE where multiline = true.
#
# secret_group: 0 = full match redacted; N > 0 = only that capture group redacted.

# ── Cloud / VCS ────────────────────────────────────────────────────────────────

[[rules]]
id           = "aws-access-key"
description  = "AWS Access Key ID"
pattern      = '''(?i)(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["aws", "cloud"]

[[rules]]
id           = "aws-secret-key"
description  = "AWS Secret Access Key"
pattern      = '''(?i)aws[_\-\s\.]{0,5}secret[_\-\s\.]{0,5}(access[_\-\s\.]{0,5})?key["'\s]*[:=]["'\s]*([A-Za-z0-9+/]{40})'''
secret_group = 2
severity     = "CRITICAL"
tags         = ["aws", "cloud"]

[[rules]]
id           = "github-pat"
description  = "GitHub Personal Access Token"
pattern      = '''(ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9_]{36,255}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["github", "token"]

[[rules]]
id           = "github-fine-grained-pat"
description  = "GitHub Fine-Grained PAT"
pattern      = '''github_pat_[A-Za-z0-9_]{82}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["github", "token"]

[[rules]]
id           = "gitlab-pat"
description  = "GitLab Personal Access Token"
pattern      = '''glpat-[A-Za-z0-9\-]{20}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["gitlab", "token"]

[[rules]]
id           = "google-api-key"
description  = "Google API Key"
pattern      = '''AIza[0-9A-Za-z\-_]{35}'''
secret_group = 0
severity     = "HIGH"
tags         = ["google", "cloud"]

[[rules]]
id           = "google-oauth-client"
description  = "Google OAuth Client Secret"
pattern      = '''GOCSPX-[A-Za-z0-9\-_]{28}'''
secret_group = 0
severity     = "HIGH"
tags         = ["google", "oauth"]

[[rules]]
id           = "stripe-secret"
description  = "Stripe Secret Key"
pattern      = '''sk_(live|test)_[A-Za-z0-9]{24,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["stripe", "payment"]

[[rules]]
id           = "stripe-publishable"
description  = "Stripe Publishable Key"
pattern      = '''pk_(live|test)_[A-Za-z0-9]{24,}'''
secret_group = 0
severity     = "LOW"
tags         = ["stripe", "payment"]

[[rules]]
id           = "slack-token"
description  = "Slack Bot/User Token"
pattern      = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''
secret_group = 0
severity     = "HIGH"
tags         = ["slack"]

[[rules]]
id           = "slack-webhook"
description  = "Slack Webhook URL"
pattern      = '''https://hooks\.slack\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[A-Za-z0-9]+'''
secret_group = 0
severity     = "HIGH"
tags         = ["slack", "webhook"]

[[rules]]
id           = "sendgrid-api"
description  = "SendGrid API Key"
pattern      = '''SG\.[A-Za-z0-9\-_]{22}\.[A-Za-z0-9\-_]{43}'''
secret_group = 0
severity     = "HIGH"
tags         = ["sendgrid", "email"]

[[rules]]
id           = "twilio-account-sid"
description  = "Twilio Account SID"
pattern      = '''AC[a-z0-9]{32}'''
secret_group = 0
severity     = "HIGH"
tags         = ["twilio"]

[[rules]]
id           = "jwt-token"
description  = "JSON Web Token"
pattern      = '''eyJ[A-Za-z0-9\-_=]+\.[A-Za-z0-9\-_=]+\.?[A-Za-z0-9\-_.+/=]*'''
secret_group = 0
severity     = "MEDIUM"
tags         = ["jwt", "auth"]

[[rules]]
id           = "private-key-header"
description  = "Private Key (PEM)"
pattern      = '''-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY( BLOCK)?-----'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["crypto", "key"]

[[rules]]
id           = "generic-secret"
description  = "Generic high-entropy secret"
pattern      = '''(?i)(secret|password|passwd|pwd|api[_-]?key|auth[_-]?token|access[_-]?token)["'\s]*[:=]["'\s]+([A-Za-z0-9!@#$%^&*()_+\-=]{16,})'''
secret_group = 2
severity     = "MEDIUM"
tags         = ["generic"]

[[rules]]
id           = "basic-auth-url"
description  = "Credentials in URL"
pattern      = '''[a-zA-Z][a-zA-Z0-9+\-.]*://[^:@\s]+:[^:@\s]+@[^@\s]+'''
secret_group = 0
severity     = "HIGH"
tags         = ["url", "credentials"]

[[rules]]
id           = "npm-token"
description  = "NPM Access Token"
pattern      = '''npm_[A-Za-z0-9]{36}'''
secret_group = 0
severity     = "HIGH"
tags         = ["npm"]

[[rules]]
id           = "docker-hub-pat"
description  = "Docker Hub PAT"
pattern      = '''dckr_pat_[A-Za-z0-9\-_]{27}'''
secret_group = 0
severity     = "HIGH"
tags         = ["docker"]

# ── LLM / AI ──────────────────────────────────────────────────────────────────

[[rules]]
id           = "openai-api-key"
description  = "OpenAI API Key"
pattern      = '''sk-(?:proj-|svcacct-)?[A-Za-z0-9\-_]{32,}T3BlbkFJ[A-Za-z0-9\-_]{20,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["llm", "openai", "ai"]

[[rules]]
id           = "openai-api-key-new"
description  = "OpenAI API Key (sk-proj format)"
pattern      = '''sk-proj-[A-Za-z0-9\-_]{50,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["llm", "openai", "ai"]

[[rules]]
id           = "anthropic-api-key"
description  = "Anthropic / Claude API Key"
pattern      = '''sk-ant-(?:api03-)?[A-Za-z0-9\-_]{32,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["llm", "anthropic", "ai"]

[[rules]]
id           = "cohere-api-key"
description  = "Cohere API Key"
pattern      = '''(?i)(?:cohere[._-]?(?:api[._-]?)?key|CO_API_KEY)\s*[=:]\s*([A-Za-z0-9]{40})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "cohere", "ai"]

[[rules]]
id           = "mistral-api-key"
description  = "Mistral AI API Key"
pattern      = '''(?i)(?:mistral[._-]?(?:api[._-]?)?key|MISTRAL_API_KEY)\s*[=:]\s*([A-Za-z0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "mistral", "ai"]

[[rules]]
id           = "huggingface-token"
description  = "Hugging Face API Token"
pattern      = '''hf_[A-Za-z0-9]{32,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["llm", "huggingface", "ai"]

[[rules]]
id           = "huggingface-token-env"
description  = "Hugging Face Token in env/config"
pattern      = '''(?i)(?:HUGGING_FACE|HUGGINGFACE)[._-]?(?:HUB[._-]?)?TOKEN\s*[=:]\s*([A-Za-z0-9_\-]{20,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["llm", "huggingface", "ai"]

[[rules]]
id           = "replicate-api-key"
description  = "Replicate API Token"
pattern      = '''r8_[A-Za-z0-9]{32,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["llm", "replicate", "ai"]

[[rules]]
id           = "together-ai-key"
description  = "Together AI API Key"
pattern      = '''(?i)TOGETHER[._-]?API[._-]?KEY\s*[=:]\s*([A-Za-z0-9]{64})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "together", "ai"]

[[rules]]
id           = "perplexity-api-key"
description  = "Perplexity AI API Key"
pattern      = '''pplx-[A-Za-z0-9]{48}'''
secret_group = 0
severity     = "HIGH"
tags         = ["llm", "perplexity", "ai"]

[[rules]]
id           = "groq-api-key"
description  = "Groq API Key"
pattern      = '''gsk_[A-Za-z0-9]{52}'''
secret_group = 0
severity     = "HIGH"
tags         = ["llm", "groq", "ai"]

[[rules]]
id           = "xai-api-key"
description  = "xAI / Grok API Key"
pattern      = '''xai-[A-Za-z0-9]{32,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["llm", "xai", "grok", "ai"]

[[rules]]
id           = "azure-openai-key"
description  = "Azure OpenAI API Key"
pattern      = '''(?i)(?:AZURE[._-]?OPENAI[._-]?(?:API[._-]?)?KEY)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "azure", "openai", "ai"]

[[rules]]
# Trailing [^A-Za-z0-9] converted to lookahead so the delimiter is not consumed/redacted.
id           = "stability-ai-key"
description  = "Stability AI API Key"
pattern      = '''sk-[A-Za-z0-9]{48}(?=[^A-Za-z0-9]|$)'''
secret_group = 0
severity     = "HIGH"
tags         = ["llm", "stability", "ai"]

# ── Azure / Entra ID / M365 ────────────────────────────────────────────────────

[[rules]]
id           = "azure-tenant-id"
description  = "Azure Tenant ID"
pattern      = '''(?i)(?:tenant[_-]?id|AZURE_TENANT_ID|tenantId)\s*[=:]\s*([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})'''
secret_group = 1
severity     = "MEDIUM"
tags         = ["azure", "entra", "m365"]

[[rules]]
id           = "azure-client-id"
description  = "Azure App Registration Client ID"
pattern      = '''(?i)(?:client[_-]?id|app[_-]?id|AZURE_CLIENT_ID|clientId|applicationId)\s*[=:]\s*([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})'''
secret_group = 1
severity     = "MEDIUM"
tags         = ["azure", "entra", "m365"]

[[rules]]
id           = "azure-client-secret"
description  = "Azure App Registration Client Secret"
pattern      = '''(?i)(?:client[_-]?secret|AZURE_CLIENT_SECRET|clientSecret)\s*[=:]\s*([A-Za-z0-9~._\-]{34,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "entra", "m365"]

[[rules]]
id           = "azure-subscription-key"
description  = "Azure API Management Subscription Key"
pattern      = '''(?i)(?:Ocp-Apim-Subscription-Key|subscription[_-]?key|APIM[_-]?KEY)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "apim"]

[[rules]]
id           = "azure-storage-account-key"
description  = "Azure Storage Account Key"
pattern      = '''(?i)(?:AccountKey|AZURE_STORAGE_KEY|storageAccountKey)\s*[=:]\s*([A-Za-z0-9+/]{86}==)'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "storage"]

[[rules]]
id           = "azure-storage-connection-string"
description  = "Azure Storage Connection String"
pattern      = '''DefaultEndpointsProtocol=https?;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/]{86}==[^;]*'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["azure", "storage"]

[[rules]]
id           = "azure-sas-token"
description  = "Azure Shared Access Signature (SAS) Token"
pattern      = '''(?:sv|sig|se|sp)=[A-Za-z0-9%+/=&\-]{8,}(?:&(?:sv|sig|se|sp|spr|srt|ss)=[A-Za-z0-9%+/=&\-]{4,}){3,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["azure", "sas", "storage"]

[[rules]]
id           = "azure-function-key"
description  = "Azure Function App Key"
pattern      = '''(?i)(?:x-functions-key|AZURE_FUNCTION_KEY|functionKey)\s*[=:]\s*([A-Za-z0-9/+]{40,}={0,2})'''
secret_group = 1
severity     = "HIGH"
tags         = ["azure", "functions"]

[[rules]]
id           = "azure-service-bus-connstr"
description  = "Azure Service Bus Connection String"
pattern      = '''Endpoint=sb://[^;]+\.servicebus\.windows\.net/;SharedAccessKeyName=[^;]+;SharedAccessKey=[A-Za-z0-9+/]{43}='''
secret_group = 0
severity     = "CRITICAL"
tags         = ["azure", "servicebus"]

[[rules]]
id           = "azure-eventhub-connstr"
description  = "Azure Event Hub Connection String"
pattern      = '''Endpoint=sb://[^;]+\.servicebus\.windows\.net/;SharedAccessKeyName=[^;]+;SharedAccessKey=[A-Za-z0-9+/]{43}=;EntityPath=[^\s]+'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["azure", "eventhub"]

[[rules]]
id           = "azure-cosmosdb-key"
description  = "Azure Cosmos DB Account Key"
pattern      = '''(?i)(?:cosmos[._-]?(?:db[._-]?)?(?:account[._-]?)?key|COSMOS_KEY)\s*[=:]\s*([A-Za-z0-9+/]{86}==)'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "cosmosdb"]

[[rules]]
id           = "azure-search-admin-key"
description  = "Azure Cognitive Search Admin Key"
pattern      = '''(?i)(?:search[._-]?(?:admin[._-]?)?key|AZURE_SEARCH_KEY)\s*[=:]\s*([A-Za-z0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "search"]

[[rules]]
id           = "azure-cognitive-key"
description  = "Azure Cognitive Services Key"
pattern      = '''(?i)(?:cognitive[._-]?(?:services[._-]?)?key|AZURE_COGNITIVE_KEY)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["azure", "cognitive", "ai"]

[[rules]]
id           = "azure-iot-hub-connstr"
description  = "Azure IoT Hub Connection String"
pattern      = '''HostName=[^;]+\.azure-devices\.net;SharedAccessKeyName=[^;]+;SharedAccessKey=[A-Za-z0-9+/]{43}='''
secret_group = 0
severity     = "CRITICAL"
tags         = ["azure", "iot"]

[[rules]]
id           = "sharepoint-client-secret"
description  = "SharePoint / M365 App Client Secret"
pattern      = '''(?i)(?:SharePoint|SPO|M365)[._-]?(?:client[._-]?)?secret\s*[=:]\s*([A-Za-z0-9+/]{32,}={0,2})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["m365", "sharepoint"]

[[rules]]
id           = "graph-api-client-secret"
description  = "Microsoft Graph API Client Secret"
pattern      = '''(?i)(?:graph[._-]?(?:api[._-]?)?(?:client[._-]?)?secret|MS_GRAPH_SECRET)\s*[=:]\s*([A-Za-z0-9~._\-]{34,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["m365", "graph", "azure"]

[[rules]]
id           = "teams-webhook"
description  = "Microsoft Teams Incoming Webhook URL"
pattern      = '''https://[a-zA-Z0-9\-]+\.webhook\.office\.com/webhookb2/[A-Za-z0-9\-@]+/IncomingWebhook/[A-Za-z0-9]+/[A-Za-z0-9\-]+'''
secret_group = 0
severity     = "HIGH"
tags         = ["m365", "teams", "webhook"]

[[rules]]
id           = "power-automate-shared-key"
description  = "Power Automate / Logic Apps Shared Key"
pattern      = '''(?i)(?:LogicApp|PowerAutomate|flow)[._-]?(?:shared[._-]?)?(?:access[._-]?)?key\s*[=:]\s*([A-Za-z0-9+/]{40,}={0,2})'''
secret_group = 1
severity     = "HIGH"
tags         = ["m365", "power-automate", "azure"]

# ── Frontend / SaaS ────────────────────────────────────────────────────────────

[[rules]]
id           = "firebase-private-key"
description  = "Firebase Admin SDK Private Key ID"
pattern      = '''(?i)(?:firebase|FIREBASE)[._-]?(?:admin[._-]?)?(?:private[._-]?)?key[._-]?(?:id)?\s*[=:]\s*([A-Za-z0-9]{40})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["firebase", "google", "frontend"]

[[rules]]
id           = "mapbox-public-token"
description  = "Mapbox Public Access Token"
pattern      = '''pk\.eyJ[A-Za-z0-9\-_=]+\.[A-Za-z0-9\-_=]+'''
secret_group = 0
severity     = "LOW"
tags         = ["mapbox", "frontend"]

[[rules]]
id           = "mapbox-secret-token"
description  = "Mapbox Secret Access Token"
pattern      = '''sk\.eyJ[A-Za-z0-9\-_=]+\.[A-Za-z0-9\-_=]+'''
secret_group = 0
severity     = "HIGH"
tags         = ["mapbox", "frontend"]

[[rules]]
id           = "sentry-dsn"
description  = "Sentry DSN (contains auth token)"
pattern      = '''https://[a-f0-9]{32}@[a-z0-9\-]+\.ingest\.sentry\.io/[0-9]+'''
secret_group = 0
severity     = "MEDIUM"
tags         = ["sentry", "observability", "frontend"]

[[rules]]
id           = "contentful-pat"
description  = "Contentful Personal Access Token"
pattern      = '''CFPAT-[A-Za-z0-9\-_]{43}'''
secret_group = 0
severity     = "HIGH"
tags         = ["contentful", "cms", "frontend"]

[[rules]]
id           = "shopify-pat"
description  = "Shopify Admin API Access Token"
pattern      = '''shpat_[A-Fa-f0-9]{32}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["shopify", "ecommerce"]

[[rules]]
id           = "shopify-shared-secret"
description  = "Shopify Shared Secret"
pattern      = '''shpss_[A-Fa-f0-9]{32}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["shopify", "ecommerce"]

[[rules]]
id           = "shopify-custom-app"
description  = "Shopify Custom App Access Token"
pattern      = '''shpca_[A-Fa-f0-9]{32}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["shopify", "ecommerce"]

[[rules]]
id           = "shopify-private-app"
description  = "Shopify Private App Access Token"
pattern      = '''shppa_[A-Fa-f0-9]{32}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["shopify", "ecommerce"]

[[rules]]
id           = "algolia-admin-key"
description  = "Algolia Admin API Key"
pattern      = '''(?i)(?:algolia[._-]?(?:admin[._-]?)?(?:api[._-]?)?key|ALGOLIA_ADMIN_KEY)\s*[=:]["'\s]*([a-f0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["algolia", "search", "frontend"]

[[rules]]
id           = "linear-api-key"
description  = "Linear API Key"
pattern      = '''lin_api_[A-Za-z0-9]{40}'''
secret_group = 0
severity     = "HIGH"
tags         = ["linear", "project-management"]

[[rules]]
id           = "postman-api-key"
description  = "Postman API Key"
pattern      = '''PMAK-[A-Za-z0-9\-]{58,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["postman", "api"]

[[rules]]
id           = "planetscale-token"
description  = "PlanetScale API Token"
pattern      = '''pscale_tkn_[A-Za-z0-9\-_]{43}'''
secret_group = 0
severity     = "HIGH"
tags         = ["planetscale", "database", "frontend"]

[[rules]]
id           = "cloudflare-api-token"
description  = "Cloudflare API Token"
pattern      = '''(?i)(?:CF[._-]?API[._-]?TOKEN|CLOUDFLARE[._-]?(?:API[._-]?)?TOKEN)\s*[=:]\s*([A-Za-z0-9\-_]{40})'''
secret_group = 1
severity     = "HIGH"
tags         = ["cloudflare", "cdn", "edge"]

[[rules]]
id           = "cloudflare-api-key"
description  = "Cloudflare Global API Key"
pattern      = '''(?i)(?:CF[._-]?API[._-]?KEY|CLOUDFLARE[._-]?(?:API[._-]?)?KEY)\s*[=:]\s*([a-f0-9]{37})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["cloudflare", "cdn", "edge"]

# ── Database ───────────────────────────────────────────────────────────────────

[[rules]]
id           = "db-postgres-url"
description  = "PostgreSQL Connection String"
pattern      = '''postgres(?:ql)?://[^:@\s]+:[^:@\s]+@[^/\s]+/\S+'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["database", "postgres"]

[[rules]]
id           = "db-mysql-url"
description  = "MySQL Connection String"
pattern      = '''mysql(?:2)?://[^:@\s]+:[^:@\s]+@[^/\s]+/\S+'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["database", "mysql"]

[[rules]]
id           = "db-mongodb-url"
description  = "MongoDB Connection String"
pattern      = '''mongodb(?:\+srv)?://[^:@\s]+:[^:@\s]+@[^/\s]+(?:/\S*)?'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["database", "mongodb"]

[[rules]]
id           = "db-redis-url"
description  = "Redis Connection String"
pattern      = '''rediss?://(?:[^:@\s]+:)[^@\s]+@[^/\s]+(?:/\d+)?'''
secret_group = 0
severity     = "HIGH"
tags         = ["database", "redis"]

[[rules]]
id           = "db-mssql-connstr"
description  = "MSSQL Connection String"
pattern      = '''(?i)(?:Server|Data Source)=[^;]+;[^;]*(?:Password|PWD)=([^;]+)'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["database", "mssql"]

[[rules]]
id           = "db-elasticsearch-url"
description  = "Elasticsearch URL with credentials"
pattern      = '''https?://[^:@\s]+:[^:@\s]+@[^/\s]*(?:920[0-9]|930[0-9])[^\s]*'''
secret_group = 0
severity     = "HIGH"
tags         = ["database", "elasticsearch"]

[[rules]]
id           = "db-amqp-url"
description  = "AMQP / RabbitMQ URL"
pattern      = '''amqps?://[^:@\s]+:[^:@\s]+@[^/\s]+'''
secret_group = 0
severity     = "HIGH"
tags         = ["database", "rabbitmq", "amqp"]

[[rules]]
id           = "db-generic-password"
description  = "Generic DB password in config"
pattern      = '''(?i)(?:db|database)[_\-\.]?(?:password|passwd|pwd)\s*[=:]\s*[^\s"']{8,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["database", "generic"]

[[rules]]
id           = "db-jdbc-url"
description  = "JDBC URL with credentials"
pattern      = '''jdbc:[a-z0-9]+://[^:@\s]*:[^@\s]+@[^\s]+'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["database", "jdbc"]

# ── OpenTelemetry / Observability ──────────────────────────────────────────────

[[rules]]
id           = "otel-endpoint-with-auth"
description  = "OTLP endpoint with credentials"
pattern      = '''https?://[^:@\s]+:[^:@\s]+@[^\s]*(?:4317|4318|otlp|otel|opentelemetry)[^\s]*'''
secret_group = 0
severity     = "HIGH"
tags         = ["opentelemetry", "otel"]

[[rules]]
id           = "otel-exporter-headers"
description  = "OTLP exporter headers with auth token"
pattern      = '''(?i)OTEL_EXPORTER_OTLP_HEADERS\s*=\s*[^\n]*(?:api[_-]?key|authorization|x-honeycomb-team)=[A-Za-z0-9\-_+/=]{12,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["opentelemetry", "otel"]

[[rules]]
id           = "honeycomb-api-key"
description  = "Honeycomb API Key"
pattern      = '''(?i)(?:x-honeycomb-team|honeycomb[._-]?(?:api[._-]?)?key)\s*[=:]\s*([A-Za-z0-9]{22,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["honeycomb", "observability"]

[[rules]]
id           = "datadog-api-key"
description  = "Datadog API Key"
pattern      = '''(?i)(?:DD_API_KEY|datadog[._-]?api[._-]?key)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "HIGH"
tags         = ["datadog", "observability"]

[[rules]]
id           = "newrelic-license-key"
description  = "New Relic License Key"
pattern      = '''(?i)(?:NEW_RELIC_LICENSE_KEY|newrelic[._-]?license[._-]?key)\s*[=:]\s*([A-Za-z0-9]{40})'''
secret_group = 1
severity     = "HIGH"
tags         = ["newrelic", "observability"]

[[rules]]
id           = "grafana-service-account"
description  = "Grafana Service Account Token"
pattern      = '''glsa_[A-Za-z0-9]{32}_[A-Fa-f0-9]{8}'''
secret_group = 0
severity     = "HIGH"
tags         = ["grafana", "observability"]

[[rules]]
id           = "lightstep-token"
description  = "Lightstep Access Token"
pattern      = '''(?i)(?:x-lightstep-access-token|lightstep[._-]?token)\s*[=:]\s*([A-Za-z0-9\-_]{20,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["lightstep", "observability"]

# ── HTTP Basic Auth ────────────────────────────────────────────────────────────

[[rules]]
id           = "http-basic-auth-header"
description  = "HTTP Authorization: Basic header"
pattern      = '''(?i)(?:Authorization|auth)\s*[:=]\s*Basic\s+([A-Za-z0-9+/]{8,}={0,2})'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "basic-auth"]

[[rules]]
id           = "http-basic-auth-curl"
description  = "curl -u / --user with credentials"
pattern      = '''curl\s+[^\n]*(?:-u|--user)\s+([^:'\s"]+:[^@'\s"]+)'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "basic-auth", "curl"]

[[rules]]
id           = "http-basic-auth-env"
description  = "Basic Auth credentials in env var"
pattern      = '''(?i)BASIC[_-]?AUTH\s*[=:]\s*([A-Za-z0-9+/]{8,}={0,2})'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "basic-auth"]

# ── HTTP Bearer Token ──────────────────────────────────────────────────────────

[[rules]]
id           = "http-bearer-header"
description  = "HTTP Authorization: Bearer token"
pattern      = '''(?i)(?:Authorization|auth)\s*[:=]\s*Bearer\s+([A-Za-z0-9\-_=+/.]{16,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "bearer"]

[[rules]]
id           = "http-bearer-env"
description  = "Bearer token in env var"
pattern      = '''(?i)BEARER[_-]?TOKEN\s*[=:]\s*([A-Za-z0-9\-_=+/.]{16,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "bearer"]

[[rules]]
id           = "http-bearer-curl"
description  = "curl -H Authorization: Bearer"
pattern      = '''(?i)curl\s+[^\n]*-H\s+"Authorization:\s*Bearer\s+([A-Za-z0-9\-_=+/.]{16,})"'''
secret_group = 1
severity     = "HIGH"
tags         = ["http", "bearer", "curl"]

# ── HTTP Warnings ──────────────────────────────────────────────────────────────

[[rules]]
id           = "http-insecure-url"
description  = "Insecure HTTP URL (prefer HTTPS)"
pattern      = '''http://[a-zA-Z0-9\-._~:/?#\[\]@!$&()*+,;=%]{4,}'''
secret_group = 0
severity     = "WARNING"
tags         = ["http", "insecure"]

[[rules]]
id           = "http-auth-over-http"
description  = "Credentials sent over plain HTTP"
pattern      = '''(?i)http://[^:@\s]+:[^:@\s]+@[^\s]+'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["http", "insecure", "credentials"]

# ── Infrastructure / CI ────────────────────────────────────────────────────────

[[rules]]
id           = "vault-service-token"
description  = "HashiCorp Vault Service Token"
pattern      = '''hvs\.[A-Za-z0-9_-]{24,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["vault", "hashicorp", "infra"]

[[rules]]
id           = "vault-batch-token"
description  = "HashiCorp Vault Batch Token"
pattern      = '''hvb\.[A-Za-z0-9_-]{24,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["vault", "hashicorp", "infra"]

[[rules]]
id           = "terraform-cloud-token"
description  = "Terraform Cloud API Token"
pattern      = '''TFC-[A-Za-z0-9]{14,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["terraform", "hashicorp", "infra"]

[[rules]]
id           = "digitalocean-pat"
description  = "DigitalOcean Personal Access Token"
pattern      = '''dop_v1_[a-f0-9]{64}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["digitalocean", "cloud"]

[[rules]]
id           = "circleci-token"
description  = "CircleCI API Token"
pattern      = '''ccipat_[A-Za-z0-9]{40,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["circleci", "ci"]

# ── Email providers ────────────────────────────────────────────────────────────

[[rules]]
id           = "resend-api-key"
description  = "Resend API Key"
pattern      = '''re_[A-Za-z0-9_-]{24,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["resend", "email"]

[[rules]]
id           = "mailgun-api-key"
description  = "Mailgun API Key"
pattern      = '''\bkey-[a-f0-9]{32}\b'''
secret_group = 0
severity     = "HIGH"
tags         = ["mailgun", "email"]

[[rules]]
id           = "postmark-server-token"
description  = "Postmark Server API Token"
pattern      = '''(?i)(?:POSTMARK[._-]?(?:SERVER[._-]?)?(?:API[._-]?)?TOKEN|X-Postmark-Server-Token)\s*[=:]\s*([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})'''
secret_group = 1
severity     = "HIGH"
tags         = ["postmark", "email"]

# ── Database / BaaS ────────────────────────────────────────────────────────────

[[rules]]
id           = "supabase-pat"
description  = "Supabase Personal Access Token"
pattern      = '''sbp_[a-f0-9]{40}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["supabase", "database"]

[[rules]]
id           = "supabase-service-role"
description  = "Supabase Service Role Key (JWT)"
pattern      = '''(?i)SUPABASE[._-]?(?:SERVICE[._-]?ROLE[._-]?)?KEY\s*[=:]\s*(eyJ[A-Za-z0-9_-]{30,}\.[A-Za-z0-9_-]{30,}\.[A-Za-z0-9_-]{27,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["supabase", "database", "jwt"]

# ── AI / Embeddings ────────────────────────────────────────────────────────────

[[rules]]
id           = "pinecone-api-key"
description  = "Pinecone API Key"
pattern      = '''pcsk_[A-Za-z0-9_]{40,}'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["pinecone", "ai", "embeddings"]

[[rules]]
id           = "elevenlabs-api-key"
description  = "ElevenLabs API Key"
pattern      = '''(?i)(?:ELEVENLABS[._-]?(?:API[._-]?)?KEY|XI_API_KEY)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "HIGH"
tags         = ["elevenlabs", "ai", "voice"]

[[rules]]
id           = "openai-api-key-env"
description  = "OpenAI API Key in env/config"
pattern      = '''(?i)(?:OPENAI[._-]?API[._-]?KEY)\s*[=:]\s*(sk-(?:proj-|svcacct-)?[A-Za-z0-9\-_]{20,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "openai", "ai", "python"]

[[rules]]
id           = "anthropic-api-key-env"
description  = "Anthropic API Key in env/config"
pattern      = '''(?i)(?:ANTHROPIC[._-]?API[._-]?KEY)\s*[=:]\s*(sk-ant-(?:api03-)?[A-Za-z0-9\-_]{16,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["llm", "anthropic", "ai", "python"]

# ── Python / LLM Secret Leaks ──────────────────────────────────────────────────

[[rules]]
id           = "python-llm-key-assignment"
description  = "Hardcoded LLM key/token in Python assignment"
pattern      = '''(?i)\b(?:openai|anthropic|azure_openai|mistral|cohere|groq|together|huggingface|hf|replicate|perplexity|xai|langsmith|pinecone|weaviate)[._-]?(?:api[._-]?)?(?:key|token|secret)\b\s*=\s*["'][^"'\n]{16,}["']'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["python", "llm", "secret", "ai"]

[[rules]]
# ^ and $ match line boundaries; multiline = true applies re.MULTILINE.
id           = "python-dotenv-llm-key"
description  = "LLM key/token in .env-style line"
pattern      = '''(?i)^\s*(?:OPENAI|ANTHROPIC|AZURE_OPENAI|MISTRAL|COHERE|GROQ|TOGETHER|HUGGINGFACE|HF|REPLICATE|PERPLEXITY|XAI|LANGSMITH|PINECONE|WEAVIATE)[A-Z0-9_]*_(?:API_)?(?:KEY|TOKEN|SECRET)\s*=\s*[^\s#]{16,}\s*$'''
secret_group = 0
severity     = "CRITICAL"
multiline    = true
tags         = ["python", "llm", "dotenv", "secret"]

[[rules]]
id           = "langsmith-api-key-env"
description  = "LangSmith/LangChain API key in env/config"
pattern      = '''(?i)\b(?:LANGSMITH|LANGCHAIN)[A-Z0-9_]*_(?:API_)?KEY\s*[=:]\s*([A-Za-z0-9_\-]{20,})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["python", "llm", "langsmith", "secret"]

[[rules]]
id           = "python-os-environ-secret"
description  = "Secret injected via os.environ assignment"
pattern      = '''(?i)\bos\.environ\[\s*["'][A-Z0-9_]*(?:API_)?(?:KEY|TOKEN|SECRET)[A-Z0-9_]*["']\s*\]\s*=\s*["'][^"'\n]{12,}["']'''
secret_group = 0
severity     = "HIGH"
tags         = ["python", "env", "secret"]

[[rules]]
id           = "python-openai-client-inline-key"
description  = "Inline API key in OpenAI client init"
pattern      = '''(?i)\bOpenAI\s*\(\s*api_key\s*=\s*["'][^"'\n]{16,}["']'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["python", "openai", "llm", "secret"]

[[rules]]
id           = "python-anthropic-client-inline-key"
description  = "Inline API key in Anthropic client init"
pattern      = '''(?i)\bAnthropic\s*\(\s*api_key\s*=\s*["'][^"'\n]{16,}["']'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["python", "anthropic", "llm", "secret"]

[[rules]]
id           = "vertex-private-key-json"
description  = "Vertex/GCP service account private key in JSON"
pattern      = '''"private_key"\s*:\s*"-----BEGIN PRIVATE KEY-----'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["python", "gcp", "vertex", "secret"]

[[rules]]
id           = "aws-bedrock-access-key-env"
description  = "AWS access key in env/config (Bedrock capable)"
pattern      = '''(?i)\bAWS_ACCESS_KEY_ID\s*[=:]\s*((?:AKIA|ASIA)[A-Z0-9]{16})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["python", "aws", "bedrock", "secret"]

[[rules]]
id           = "aws-bedrock-secret-key-env"
description  = "AWS secret access key in env/config (Bedrock capable)"
pattern      = '''(?i)\bAWS_SECRET_ACCESS_KEY\s*[=:]\s*([A-Za-z0-9/+=]{40})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["python", "aws", "bedrock", "secret"]

[[rules]]
id           = "streamlit-secrets-llm-key"
description  = "LLM key in Streamlit secrets.toml style"
pattern      = '''(?i)\b(?:openai|anthropic|langsmith|cohere|mistral|groq|together|huggingface|replicate|perplexity|xai)[._-]?(?:api[._-]?)?(?:key|token|secret)\s*=\s*["'][^"'\n]{16,}["']'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["python", "streamlit", "llm", "secret"]

# ── Communication ──────────────────────────────────────────────────────────────

[[rules]]
id           = "slack-signing-secret"
description  = "Slack Signing Secret"
pattern      = '''(?i)(?:SLACK_SIGNING_SECRET|slack[._-]?signing[._-]?secret)\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "HIGH"
tags         = ["slack", "communication"]

[[rules]]
id           = "slack-app-token"
description  = "Slack App-Level Token"
pattern      = '''xapp-[0-9]-[A-Z0-9]+-[0-9]+-[a-f0-9]{64}'''
secret_group = 0
severity     = "HIGH"
tags         = ["slack", "communication"]

[[rules]]
id           = "twilio-auth-token"
description  = "Twilio Auth Token"
pattern      = '''(?i)TWILIO[._-]?AUTH[._-]?TOKEN\s*[=:]\s*([a-f0-9]{32})'''
secret_group = 1
severity     = "CRITICAL"
tags         = ["twilio", "communication"]

[[rules]]
id           = "discord-bot-token"
description  = "Discord Bot Token"
pattern      = '''(?i)(?:discord[._-]?(?:bot[._-]?)?token|DISCORD_TOKEN)\s*[=:]\s*([A-Za-z0-9_-]{24,26}\.[A-Za-z0-9_-]{6}\.[A-Za-z0-9_-]{27,})'''
secret_group = 1
severity     = "HIGH"
tags         = ["discord", "communication"]

[[rules]]
id           = "telegram-bot-token"
description  = "Telegram Bot Token"
pattern      = '''[0-9]{8,12}:[A-Za-z0-9_-]{35}'''
secret_group = 0
severity     = "HIGH"
tags         = ["telegram", "communication"]

[[rules]]
id           = "notion-integration-token"
description  = "Notion Integration Token"
pattern      = '''secret_[A-Za-z0-9]{43}'''
secret_group = 0
severity     = "HIGH"
tags         = ["notion", "communication"]

[[rules]]
id           = "notion-oauth-token"
description  = "Notion OAuth Access Token"
pattern      = '''ntn_[A-Za-z0-9]{40,}'''
secret_group = 0
severity     = "HIGH"
tags         = ["notion", "communication"]

# ── GCP ───────────────────────────────────────────────────────────────────────

[[rules]]
id           = "gcp-service-account"
description  = "GCP Service Account JSON"
pattern      = '''"type"\s*:\s*"service_account"'''
secret_group = 0
severity     = "CRITICAL"
tags         = ["gcp", "google", "cloud"]
